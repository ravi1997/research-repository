<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Article</title>
    <link rel="stylesheet" href="/researchrepository/constant/style/style.css">
    <link rel="stylesheet" href="/researchrepository/constant/style/article.css">
</head>

<body>
    <header>
        <h1>AIIMS Research Publication Repository</h1>
        <nav>
            <div class="button">
                <a href="/researchrepository/login">Login</a>
            </div>
        </nav>
    </header>

    <main class="article">
        <h1>Edit Article</h1>

        <form action="/researchrepository/api/article/{{ article.id }}" method="POST">
            <!-- Title -->
            <section class="section">
                <h2>Title</h2>
                <input type="text" name="title" value="{{ article.title }}" required>
            </section>

            <!-- Abstract -->
            <section class="section">
                <h2>Abstract</h2>
                <textarea name="abstract" rows="5" required>{{ article.abstract }}</textarea>
            </section>

            <!-- Authors -->
            <div class="section">
                <h2>Authors</h2>
                <div id="authors-container">
                    {% for author in article.authors %}
                    <div class="author-entry">
                        <input type="text" name="authors[{{ loop.index }}][fullName]" value="{{ author.fullName }}"
                            placeholder="Full Name" required>
                        <input type="text" name="authors[{{ loop.index }}][affiliations]"
                            value="{{ author.affiliations }}" placeholder="Affiliation">
                        <input type="text" name="authors[{{ loop.index }}][author_abbreviated]"
                            value="{{ author.author_abbreviated }}" placeholder="Author Abbreviated">
                        <button type="button" class="remove-author" onclick="removeAuthor(this)">Remove Author</button>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="add-author" onclick="addAuthor()">Add Author</button>
            </div>

            <!-- Publication Details -->
            <section class="section">
                <h2>Publication Details</h2>
                <input type="text" name="journal" value="{{ article.journal }}" placeholder="Journal" required>
                <input type="text" name="journal_abrevated" value="{{ article.journal_abrevated }}"
                    placeholder="Journal Abbreviation" required>
                <input type="text" name="journal_volume" value="{{ article.journal_volume }}" placeholder="Volume"
                    required>
                <input type="text" name="journal_issue" value="{{ article.journal_issue }}" placeholder="Issue"
                    required>
                <input type="text" name="pages" value="{{ article.pages }}" placeholder="Pages" required>
                <input type="date" name="publication_date" value="{{ article.publication_date }}"
                    placeholder="Published Date" required>
                <input type="text" name="print_issn" value="{{ article.print_issn }}" placeholder="Print ISSN" required>
                <input type="text" name="electronic_issn" value="{{ article.electronic_issn }}"
                    placeholder="Electronic ISSN">
                <input type="text" name="place_of_publication" value="{{ article.place_of_publication }}"
                    placeholder="Place of Publication">
                <input type="text" name="pmc_id" value="{{ article.pmc_id }}" placeholder="PMC ID">
                <input type="text" name="pubmed_id" value="{{ article.pubmed_id }}" placeholder="PubMed ID">
                <input type="text" name="pii" value="{{ article.pii }}" placeholder="PII">
            </section>

            <!-- Keywords -->
            <section class="section">
                <h2>Keywords</h2>
                <div id="keywords-container">
                    {% for keyword in article.keywords %}
                    <input type="text" name="keywords[{{ loop.index }}][keyword]" value="{{ keyword.keyword }}"
                        placeholder="Keyword" required>
                    {% endfor %}
                </div>
                <button type="button" class="add-keyword" onclick="addKeyword()">Add Keyword</button>
            </section>

            <!-- DOI and Links -->
            <section class="section">
                <h2>DOI and Links</h2>
                <input type="text" name="doi" value="{{ article.doi }}" placeholder="DOI" required>
                <div id="links-container">
                    {% for link in article.links %}
                    <input type="url" name="links[{{ loop.index }}][link]" value="{{ link.link }}" placeholder="Link"
                        required>
                    <button type="button" class="remove-link" onclick="removeLink(this)">Remove Link</button>
                    {% endfor %}
                </div>
                <button type="button" class="add-link" onclick="addLink()">Add Link</button>
            </section>

            <div class="form-actions">
                <button type="submit" class="button">Save Changes</button>
                <a href="/researchrepository/article/{{ article.id }}" class="button">Cancel</a>
            </div>
        </form>
    </main>

    <footer>
        <p>&copy; 2024 AIIMS Research Repository. All Rights Reserved.</p>
    </footer>

    <script>
        // Add new author fields
        function addAuthor() {
            const authorsContainer = document.getElementById('authors-container');
            const authorEntry = document.createElement('div');
            authorEntry.classList.add('author-entry');
            authorEntry.innerHTML = `
                <input type="text" name="authors[][fullName]" placeholder="Full Name" required>
                <input type="text" name="authors[][affiliations]" placeholder="Affiliation">
                <input type="text" name="authors[][author_abbreviated]" placeholder="Author Abbreviated">
                <button type="button" class="remove-author" onclick="removeAuthor(this)">Remove Author</button>
            `;
            authorsContainer.appendChild(authorEntry);
        }

        // Remove author entry
        function removeAuthor(button) {
            button.parentElement.remove();
        }

        // Add new keyword field
        function addKeyword() {
            const keywordsContainer = document.getElementById('keywords-container');
            const keywordInput = document.createElement('input');
            keywordInput.type = 'text';
            keywordInput.name = 'keywords[][keyword]';
            keywordInput.placeholder = 'Keyword';
            keywordsContainer.appendChild(keywordInput);
        }

        // Add new link field
        function addLink() {
            const linksContainer = document.getElementById('links-container');
            const linkInput = document.createElement('input');
            linkInput.type = 'url';
            linkInput.name = 'links[][link]';
            linkInput.placeholder = 'Link';
            linksContainer.appendChild(linkInput);
        }

        // Remove link entry
        function removeLink(button) {
            button.parentElement.remove();
        }
    </script>
</body>

</html>